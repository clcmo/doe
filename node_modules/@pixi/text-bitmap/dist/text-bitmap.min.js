/*!
 * @pixi/text-bitmap - v5.3.12
 * Compiled Wed, 23 Mar 2022 18:34:28 UTC
 *
 * @pixi/text-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PIXI=this.PIXI||{};var _pixi_text_bitmap=function(t,e,r,n,i,a,o,s,h){"use strict";var f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var l=function(){return function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]}}(),u=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var n in e){var i=e[n].match(/^[a-z]+/gm)[0],a=e[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var s in a){var h=a[s].split("="),f=h[0],u=h[1].replace(/"/gm,""),c=parseFloat(u),p=isNaN(c)?u:c;o[f]=p}r[i].push(o)}var g=new l;return r.info.forEach(function(t){return g.info.push({face:t.face,size:parseInt(t.size,10)})}),r.common.forEach(function(t){return g.common.push({lineHeight:parseInt(t.lineHeight,10)})}),r.page.forEach(function(t){return g.page.push({id:parseInt(t.id,10),file:t.file})}),r.char.forEach(function(t){return g.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})}),r.kerning.forEach(function(t){return g.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})}),g},t}(),c=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new l,r=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),s=0;s<r.length;s++)e.info.push({face:r[s].getAttribute("face"),size:parseInt(r[s].getAttribute("size"),10)});for(s=0;s<n.length;s++)e.common.push({lineHeight:parseInt(n[s].getAttribute("lineHeight"),10)});for(s=0;s<i.length;s++)e.page.push({id:parseInt(i[s].getAttribute("id"),10)||0,file:i[s].getAttribute("file")});for(s=0;s<a.length;s++){var h=a[s];e.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(s=0;s<o.length;s++)e.kerning.push({first:parseInt(o[s].getAttribute("first"),10),second:parseInt(o[s].getAttribute("second"),10),amount:parseInt(o[s].getAttribute("amount"),10)});return e},t}(),p=function(){function t(){}return t.test=function(t){if("string"==typeof t&&t.indexOf("<font>")>-1){var e=(new self.DOMParser).parseFromString(t,"text/xml");return c.test(e)}return!1},t.parse=function(t){var e=(new window.DOMParser).parseFromString(t,"text/xml");return c.parse(e)},t}(),g=[u,c,p];function d(t){for(var e=0;e<g.length;e++)if(g[e].test(t))return g[e];return null}function v(t,e,r,n,a,s,h){var f=r.text,l=r.fontProperties;e.translate(n,a),e.scale(s,s);var u=h.strokeThickness/2,c=-h.strokeThickness/2;if(e.font=h.toFontString(),e.lineWidth=h.strokeThickness,e.textBaseline=h.textBaseline,e.lineJoin=h.lineJoin,e.miterLimit=h.miterLimit,e.fillStyle=function(t,e,r,n,i,a){var s,h=r.fill;if(!Array.isArray(h))return h;if(1===h.length)return h[0];var f=r.dropShadow?r.dropShadowDistance:0,l=r.padding||0,u=Math.ceil(t.width/n)-f-2*l,c=Math.ceil(t.height/n)-f-2*l,p=h.slice(),g=r.fillGradientStops.slice();if(!g.length)for(var d=p.length+1,v=1;v<d;++v)g.push(v/d);if(p.unshift(h[0]),g.unshift(0),p.push(h[h.length-1]),g.push(1),r.fillGradientType===o.TEXT_GRADIENT.LINEAR_VERTICAL){s=e.createLinearGradient(u/2,l,u/2,c+l);var x=0,m=(a.fontProperties.fontSize+r.strokeThickness)/c;for(v=0;v<i.length;v++)for(var y=a.lineHeight*v,b=0;b<p.length;b++){var _=y/c+("number"==typeof g[b]?g[b]:b/p.length)*m,I=Math.max(x,_);I=Math.min(I,1),s.addColorStop(I,p[b]),x=I}}else{s=e.createLinearGradient(l,c/2,u+l,c/2);var w=p.length+1,P=1;for(v=0;v<p.length;v++){var T=void 0;T="number"==typeof g[v]?g[v]:P/w,s.addColorStop(T,p[v]),P++}}return s}(t,e,h,s,[f],r),e.strokeStyle=h.stroke,h.dropShadow){var p=h.dropShadowColor,g=i.hex2rgb("number"==typeof p?p:i.string2hex(p)),d=h.dropShadowBlur*s,v=h.dropShadowDistance*s;e.shadowColor="rgba("+255*g[0]+","+255*g[1]+","+255*g[2]+","+h.dropShadowAlpha+")",e.shadowBlur=d,e.shadowOffsetX=Math.cos(h.dropShadowAngle)*v,e.shadowOffsetY=Math.sin(h.dropShadowAngle)*v}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;h.stroke&&h.strokeThickness&&e.strokeText(f,u,c+r.lineHeight-l.descent),h.fill&&e.fillText(f,u,c+r.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}var x=function(){function t(t,r,n){var o=t.info[0],s=t.common[0],h=t.page[0],f=i.getResolutionOfUrl(h.file),l={};this._ownsTextures=n,this.font=o.face,this.size=o.size,this.lineHeight=s.lineHeight/f,this.chars={},this.pageTextures=l;for(var u=0;u<t.page.length;u++){var c=t.page[u],p=c.id,g=c.file;l[p]=r instanceof Array?r[u]:r[g]}for(u=0;u<t.char.length;u++){var d=t.char[u],v=(p=d.id,d.page),x=t.char[u],m=x.x,y=x.y,b=x.width,_=x.height,I=x.xoffset,w=x.yoffset,P=x.xadvance;m/=f,y/=f,b/=f,_/=f,I/=f,w/=f,P/=f;var T=new e.Rectangle(m+l[v].frame.x/f,y+l[v].frame.y/f,b,_);this.chars[p]={xOffset:I,yOffset:w,xAdvance:P,kerning:{},texture:new a.Texture(l[v].baseTexture,T),page:v}}for(u=0;u<t.kerning.length;u++){var A=t.kerning[u],S=A.first,O=A.second,E=A.amount;S/=f,O/=f,E/=f,this.chars[O]&&(this.chars[O].kerning[S]=E)}}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,r,n){var i;if(e instanceof l)i=e;else{var o=d(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}r instanceof a.Texture&&(r=[r]);var s=new t(i,r,n);return t.available[s.font]=s,s},t.uninstall=function(e){var r=t.available[e];if(!r)throw new Error("No font found named '"+e+"'");r.destroy(),delete t.available[e]},t.from=function(e,r,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var i=Object.assign({},t.defaultOptions,n),s=i.chars,h=i.padding,f=i.resolution,u=i.textureWidth,c=i.textureHeight,p=function(t){"string"==typeof t&&(t=[t]);for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];if(Array.isArray(i)){if(2!==i.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+i.length+".");var a=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<a)throw new Error("[BitmapFont]: Invalid character range.");for(var s=a,h=o;s<=h;s++)e.push(String.fromCharCode(s))}else e.push.apply(e,i.split(""))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(s),g=r instanceof o.TextStyle?r:new o.TextStyle(r),d=u,x=new l;x.info[0]={face:g.fontFamily,size:g.fontSize},x.common[0]={lineHeight:g.fontSize};for(var m,y,b,_=0,I=0,w=0,P=[],T=[],A=0;A<p.length;A++){m||((m=document.createElement("canvas")).width=u,m.height=c,y=m.getContext("2d"),b=new a.BaseTexture(m,{resolution:f}),P.push(b),T.push(new a.Texture(b)),x.page.push({id:T.length-1,file:""}));var S=o.TextMetrics.measureText(p[A],g,!1,m),O=S.width,E=Math.ceil(S.height),M=Math.ceil(("italic"===g.fontStyle?2:1)*O);if(I>=c-E*f){if(0===I)throw new Error("[BitmapFont] textureHeight "+c+"px is too small for "+g.fontSize+"px fonts");--A,m=null,y=null,b=null,I=0,_=0,w=0}else if(w=Math.max(E+S.fontProperties.descent,w),M*f+_>=d)--A,I+=w*f,I=Math.ceil(I),_=0,w=0;else{v(m,y,S,_,I,f,g);var B=S.text.charCodeAt(0);x.char.push({id:B,page:T.length-1,x:_/f,y:I/f,width:M,height:E,xoffset:0,yoffset:0,xadvance:Math.ceil(O-(g.dropShadow?g.dropShadowDistance:0)-(g.stroke?g.strokeThickness:0))}),_+=(M+2*h)*f,_=Math.ceil(_)}}var z=new t(x,T,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=z,z},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),m=[],y=[],b=function(t){function o(n,a){void 0===a&&(a={});var s=t.call(this)||this;s._tint=16777215,a.font&&(i.deprecation("5.3.0","PIXI.BitmapText constructor style.font property is deprecated."),s._upgradeStyle(a));var h=Object.assign({},o.styleDefaults,a),f=h.align,l=h.tint,u=h.maxWidth,c=h.letterSpacing,p=h.fontName,g=h.fontSize;if(!x.available[p])throw new Error('Missing BitmapFont "'+p+'"');return s._activePagesMeshData=[],s._textWidth=0,s._textHeight=0,s._align=f,s._tint=l,s._fontName=p,s._fontSize=g||x.available[p].size,s._text=n,s._maxWidth=u,s._maxLineHeight=0,s._letterSpacing=c,s._anchor=new e.ObservablePoint(function(){s.dirty=!0},s,0,0),s._roundPixels=r.settings.ROUND_PIXELS,s.dirty=!0,s._textureCache={},s}return function(t,e){function r(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(o,t),o.prototype.updateText=function(){for(var t,r=x.available[this._fontName],o=this._fontSize/r.size,s=new e.Point,h=[],f=[],l=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",u=l.length,c=this._maxWidth*r.size/this._fontSize,p=null,g=0,d=0,v=0,b=-1,_=0,I=0,w=0,P=0;P<u;P++){var T=l.charCodeAt(P),A=l.charAt(P);if(/(?:\s)/.test(A)&&(b=P,_=g),"\r"!==A&&"\n"!==A){var S=r.chars[T];if(S){p&&S.kerning[p]&&(s.x+=S.kerning[p]);var O=y.pop()||{texture:a.Texture.EMPTY,line:0,charCode:0,position:new e.Point};O.texture=S.texture,O.line=v,O.charCode=T,O.position.x=s.x+S.xOffset+this._letterSpacing/2,O.position.y=s.y+S.yOffset,h.push(O),s.x+=S.xAdvance+this._letterSpacing,g=s.x,w=Math.max(w,S.yOffset+S.texture.height),p=T,-1!==b&&c>0&&s.x>c&&(++I,i.removeItems(h,1+b-I,1+P-b),P=b,b=-1,f.push(_),d=Math.max(d,_),v++,s.x=0,s.y+=r.lineHeight,p=null)}}else f.push(g),d=Math.max(d,g),++v,++I,s.x=0,s.y+=r.lineHeight,p=null}var E=l.charAt(l.length-1);"\r"!==E&&"\n"!==E&&(/(?:\s)/.test(E)&&(g=_),f.push(g),d=Math.max(d,g));var M=[];for(P=0;P<=v;P++){var B=0;"right"===this._align?B=d-f[P]:"center"===this._align&&(B=(d-f[P])/2),M.push(B)}var z=h.length,C={},k=[],H=this._activePagesMeshData;for(P=0;P<H.length;P++)m.push(H[P]);for(P=0;P<z;P++){var F=(G=h[P].texture).baseTexture.uid;if(!C[F]){if(!(K=m.pop())){var N=new n.MeshGeometry,X=new n.MeshMaterial(a.Texture.EMPTY);K={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new n.Mesh(N,X),vertices:null,uvs:null,indices:null}}K.index=0,K.indexCount=0,K.vertexCount=0,K.uvsCount=0,K.total=0;var L=this._textureCache;L[F]=L[F]||new a.Texture(G.baseTexture),K.mesh.texture=L[F],K.mesh.tint=this._tint,k.push(K),C[F]=K}C[F].total++}for(P=0;P<H.length;P++)-1===k.indexOf(H[P])&&this.removeChild(H[P].mesh);for(P=0;P<k.length;P++)k[P].mesh.parent!==this&&this.addChild(k[P].mesh);for(var P in this._activePagesMeshData=k,C){var j=(K=C[P]).total;if(!((null===(t=K.indices)||void 0===t?void 0:t.length)>6*j)||K.vertices.length<2*n.Mesh.BATCHABLE_SIZE)K.vertices=new Float32Array(8*j),K.uvs=new Float32Array(8*j),K.indices=new Uint16Array(6*j);else for(var D=K.total,U=K.vertices,W=4*D*2;W<U.length;W++)U[W]=0;K.mesh.size=6*j}for(P=0;P<z;P++){var R=(A=h[P]).position.x+M[A.line];this._roundPixels&&(R=Math.round(R));var G,Y=R*o,Z=A.position.y*o,$=C[(G=A.texture).baseTexture.uid],J=G.frame,V=G._uvs,q=$.index++;$.indices[6*q+0]=0+4*q,$.indices[6*q+1]=1+4*q,$.indices[6*q+2]=2+4*q,$.indices[6*q+3]=0+4*q,$.indices[6*q+4]=2+4*q,$.indices[6*q+5]=3+4*q,$.vertices[8*q+0]=Y,$.vertices[8*q+1]=Z,$.vertices[8*q+2]=Y+J.width*o,$.vertices[8*q+3]=Z,$.vertices[8*q+4]=Y+J.width*o,$.vertices[8*q+5]=Z+J.height*o,$.vertices[8*q+6]=Y,$.vertices[8*q+7]=Z+J.height*o,$.uvs[8*q+0]=V.x0,$.uvs[8*q+1]=V.y0,$.uvs[8*q+2]=V.x1,$.uvs[8*q+3]=V.y1,$.uvs[8*q+4]=V.x2,$.uvs[8*q+5]=V.y2,$.uvs[8*q+6]=V.x3,$.uvs[8*q+7]=V.y3}for(var P in this._textWidth=d*o,this._textHeight=(s.y+r.lineHeight)*o,C){var K=C[P];if(0!==this.anchor.x||0!==this.anchor.y)for(var Q=0,tt=this._textWidth*this.anchor.x,et=this._textHeight*this.anchor.y,rt=0;rt<K.total;rt++)K.vertices[Q++]-=tt,K.vertices[Q++]-=et,K.vertices[Q++]-=tt,K.vertices[Q++]-=et,K.vertices[Q++]-=tt,K.vertices[Q++]-=et,K.vertices[Q++]-=tt,K.vertices[Q++]-=et;this._maxLineHeight=w*o;var nt=K.mesh.geometry.getBuffer("aVertexPosition"),it=K.mesh.geometry.getBuffer("aTextureCoord"),at=K.mesh.geometry.getIndex();nt.data=K.vertices,it.data=K.uvs,at.data=K.indices,nt.update(),it.update(),at.update()}for(P=0;P<h.length;P++)y.push(h[P])},o.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},o.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},o.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(o.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!x.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),o.prototype._upgradeStyle=function(t){if("string"==typeof t.font){var e=t.font.split(" ");t.fontName=1===e.length?e[0]:e.slice(1).join(" "),e.length>=2&&(t.fontSize=parseInt(e[0],10))}else t.fontName=t.font.name,t.fontSize="number"==typeof t.font.size?t.font.size:parseInt(t.font.size,10)},o.prototype.destroy=function(e){var r=this._textureCache;for(var n in r){r[n].destroy(),delete r[n]}this._textureCache=null,t.prototype.destroy.call(this,e)},o.registerFont=function(t,e){return i.deprecation("5.3.0","PIXI.BitmapText.registerFont is deprecated, use PIXI.BitmapFont.install"),x.install(t,e)},Object.defineProperty(o,"fonts",{get:function(){return i.deprecation("5.3.0","PIXI.BitmapText.fonts is deprecated, use PIXI.BitmapFont.available"),x.available},enumerable:!1,configurable:!0}),o.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},o}(s.Container),_=function(){function t(){}return t.add=function(){h.LoaderResource.setExtensionXhrType("fnt",h.LoaderResource.XHR_RESPONSE_TYPE.TEXT)},t.use=function(e,r){var n=d(e.data);if(n)for(var i=t.getBaseUrl(this,e),a=n.parse(e.data),o={},s=function(t){o[t.metadata.pageFile]=t.texture,Object.keys(o).length===a.page.length&&(e.bitmapFont=x.install(a,o,!0),r())},f=0;f<a.page.length;++f){var l=a.page[f].file,u=i+l,c=!1;for(var p in this.resources){var g=this.resources[p];if(g.url===u){g.metadata.pageFile=l,g.texture?s(g):g.onAfterMiddleware.add(s),c=!0;break}}if(!c){var v={crossOrigin:e.crossOrigin,loadType:h.LoaderResource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:l},e.metadata.imageMetadata),parentResource:e};this.add(u,v,s)}}else r()},t.getBaseUrl=function(e,r){var n=r.isDataUrl?"":t.dirname(r.url);return r.isDataUrl&&("."===n&&(n=""),e.baseUrl&&n&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(n+="/")),(n=n.replace(e.baseUrl,""))&&"/"!==n.charAt(n.length-1)&&(n+="/"),n},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t}();return t.BitmapFont=x,t.BitmapFontData=l,t.BitmapFontLoader=_,t.BitmapText=b,t}({},PIXI,PIXI,PIXI,PIXI.utils,PIXI,PIXI,PIXI,PIXI);Object.assign(this.PIXI,_pixi_text_bitmap);
//# sourceMappingURL=text-bitmap.min.js.map
